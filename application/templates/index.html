{% extends 'layouts/base.html' %}


{% set app_header_classes = "app-header--flush" %}

{% block mastHead %}
<header class="govuk-header {{ app_header_classes }} govuk-!-padding-top-2" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-width-container app-govuk-header__container">
    <div class="app-header__content">
      <span class="app-header__team-name">
        <a href="https://digital-land.info"
          class="govuk-header__link govuk-header__link--homepage app-govuk-header__link--homepage app-govuk-header__link--homepage--bold">
          <span class="govuk-header__logotype-text">
            Digital Land
          </span>
        </a>
      </span>
    </div>
  </div>
</header>
{% endblock mastHead %}

{% block main %}
<main id="content" role="main">

  {% if session['user'] %}
    {% from 'components/user-bar.html' import appUserBar %}
    <div class="govuk-width-container">
      {{ appUserBar({
        "user": session['user'],
        "classes": "govuk-!-margin-bottom-0"
      }) }}
    </div>
  {% endif %}

  <section class="app-hero{{ ' app-hero--flush' if session['user'] }} govuk-!-padding-top-0 govuk-!-margin-bottom-6" id="intro">
    <div class="app-hero__content govuk-width-container">

      {{ govukPhaseBanner({
        "tag": { "text": "BETA" },
        "html": 'This is a new service â€“ your <a class="govuk-link govuk-link--inverse" href="/feedback">feedback</a> will help us to improve it.',
        "classes": "app-masthead__phase-banner app-masthead__phase-banner--inverse"
      }) }}
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
          <h1 class="govuk-heading-xl govuk-!-margin-bottom-4">Manage Service</h1>
          <p class="govuk-body-l">A service to help manage the Planning Data Platform's configuration data and processing pipelines</p>
        </div>
        <div class="govuk-grid-column-one-third"></div>
      </div>
    </div>
  </section>

  <section class="govuk-width-container app-tools-list">

    {# Flash messages: keep using Notification banner inside page content #}
    {%- from "govuk_frontend_jinja/components/notification-banner/macro.html" import govukNotificationBanner %}
    {%- with messages = get_flashed_messages() %}
      {%- if messages %}
        {%- set flashMessageHtml %}
          {% for message in messages %}
            <p class="govuk-notification-banner__heading">{{ message }}.</p>
          {% endfor %}
        {% endset -%}
        {{ govukNotificationBanner({ "html": flashMessageHtml }) }}
      {%- endif %}
    {%- endwith %}

    <h2 class="govuk-heading-m">Processes</h2>

    {% if not authentication_on or session['user'] %}
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-one-third">
        <a class="app-tools-list__item" href="{{ url_for('datamanager.dashboard_get')}}">
          <h3 class="govuk-heading-s app-tools-list__item__heading">Add data</h3>
          <p class="govuk-body">Add and validate new data for datasets</p>
        </a>
      </div>
      <div class="govuk-grid-column-one-third">
        <div class="app-tools-list__item" style="opacity: 0.5; cursor: not-allowed; pointer-events: none;">
          <h3 class="govuk-heading-s app-tools-list__item__heading">Assign Entities</h3>
          <p class="govuk-body">Assign entity numbers to new data entries</p>
        </div>
      </div>
    </div><!-- /.govuk-grid-row -->
    {% else %}
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <div class="govuk-inset-text">
          <p class="govuk-body">You must be <a href="{{ url_for('auth.login') }}" class="govuk-link">logged in</a> to run processes.</p>
        </div>
      </div>
    </div><!-- /.govuk-grid-row -->
    {% endif %}

    <h2 class="govuk-heading-m govuk-!-margin-top-9">Configuration</h2>

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-one-third">
        <a class="app-tools-list__item" href="{{ url_for('dataset.index')}}">
          <h3 class="govuk-heading-s app-tools-list__item__heading">Pipeline configuration for datasets</h3>
          <p class="govuk-body">Configure the processing of source data into digital land datasets</p>
        </a>
      </div>
    </div><!-- /.govuk-grid-row -->

    <h2 class="govuk-heading-m govuk-!-margin-top-9">Reporting (under construction)</h2>

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-one-third">
        <a class="app-tools-list__item" href="{{ url_for('reporting.overview')}}">
          <h3 class="govuk-heading-s app-tools-list__item__heading">Overview</h3>
          <p class="govuk-body">General metrics on the platform</p>
        </a>
      </div>
      <div class="govuk-grid-column-one-third">
        <a class="app-tools-list__item" href="{{ url_for('reporting.overview_of_datasets')}}">
          <h3 class="govuk-heading-s app-tools-list__item__heading">Overview of Datasets</h3>
          <p class="govuk-body">An overview of the entire platform</p>
        </a>
      </div>
      <div class="govuk-grid-column-one-third">
        <a class="app-tools-list__item" href="{{ url_for('reporting.odp_status_summary')}}">
          <h3 class="govuk-heading-s app-tools-list__item__heading">ODP Summary</h3>
          <p class="govuk-body">Summary metrics for ODP cohorts</p>
        </a>
      </div>
    </div><!-- /.govuk-grid-row -->

    <h2 class="govuk-heading-m govuk-!-margin-top-9">Sources and endpoints</h2>

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-one-third">
        <a class="app-tools-list__item" href="{{ url_for('source.search') }}">
          <h3 class="govuk-heading-s app-tools-list__item__heading">Find a source</h3>
          <p class="govuk-body">Use this tool to find a source.</p>
        </a>
      </div>
      <div class="govuk-grid-column-one-third">
        <a class="app-tools-list__item" href="{{ url_for('source.add') }}">
          <h3 class="govuk-heading-s app-tools-list__item__heading">Add a source</h3>
          <p class="govuk-body">Use this tool to add new sources for a dataset.</p>
        </a>
      </div>
      <div class="govuk-grid-column-one-third">
        <a class="app-tools-list__item" href="{{ url_for('source.search') }}">
          <h3 class="govuk-heading-s app-tools-list__item__heading">Edit source</h3>
          <p class="govuk-body">Use this tool to edit a source.</p>
        </a>
      </div>
    </div><!-- /.govuk-grid-row -->

  </section>

  <section class="govuk-width-container app-tools-list">
    <h2 class="govuk-heading-m">Documentation</h2>
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-one-third">
        <a class="app-tools-list__item" href="https://docs.google.com/document/d/1F7dAbsRjallMzsgdPNhwszdzV9OpENx_rWWYssLxdvE/edit?usp=sharing">
          <h3 class="govuk-heading-s app-tools-list__item__heading">Ops manual</h3>
          <p class="govuk-body">Documentation for a set of data management related procedures.</p>
        </a>
      </div>
    </div><!-- /.govuk-grid-row -->
  </section>

</main>
{% endblock main %}
